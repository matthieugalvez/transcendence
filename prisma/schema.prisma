generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = "file:./transcendence.db"
}

model	User {
	id				Int			@id @default(autoincrement())
	email			String		@unique
	displayName		String?
	password_hash	String
	provider		String		@default("local") // "local" or "google"
	refreshToken	String?
	twoFAEnabled	Boolean		@default(false)
	twoFASecret		String?
	avatar			String		@default("./db/users/default")
	created_at		DateTime	@default(now())
	updated_at		DateTime	@updatedAt

	messages_send		Message[]	@relation("sender")
	messages_received	Message[]	@relation("receiver")

	@@map("users")
}

model	Message {
	id			Int			@id @default(autoincrement())
	sender_id	Int
	receiver_id	Int
	created_at	DateTime	@default(now())
	updated_at	DateTime	@updatedAt
	content		String

	sender		User	@relation("sender", fields: [sender_id], references: [id])
	receiver	User	@relation("receiver", fields: [receiver_id], references: [id])

	@@map("messages")
}
